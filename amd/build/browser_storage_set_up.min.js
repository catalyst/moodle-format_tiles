define(["jquery"],function($){"use strict";var storageUserConsent={GIVEN:"yes",DENIED:"no"};var localStorageKeyElements={userPrefStorage:"mdl-tiles-userPrefStorage",user:"-user-"};var storageType={local:"local",session:"session"};var Enabled={local:false,session:false};var userId;var userChoice=null;var encodeStorageKey=function(){return localStorageKeyElements.userPrefStorage+localStorageKeyElements.user+userId};var storageAllowed=function(){if(userChoice!==null){return userChoice}else{var browserChoice=localStorage.getItem(encodeStorageKey());if(browserChoice){userChoice=browserChoice===storageUserConsent.GIVEN;return userChoice}else{return null}}};var setAllowed=function(allowedOrNot){if(allowedOrNot){userChoice=true;localStorage.setItem(encodeStorageKey(),storageUserConsent.GIVEN)}else{userChoice=false;localStorage.setItem(encodeStorageKey(),storageUserConsent.DENIED)}};var obtainUserPreference=function(cleanUpFunc){require(["core/str","core/notification"],function(str,Notification){str.get_strings([{key:"datapref",component:"format_tiles"},{key:"dataprefquestion",component:"format_tiles"},{key:"yes"},{key:"no"}]).done(function(s){Notification.confirm(s[0],s[1],s[2],s[3],function(){setAllowed(true)},function(){setAllowed(false);if(typeof cleanUpFunc==="function"){cleanUpFunc()}})})})};var storageInitialCheck=function(localOrSession){var storage;try{if(localOrSession===storageType.local){storage=localStorage}else if(localOrSession===storageType.session){storage=sessionStorage}if(typeof storage==="undefined"){return false}storage.setItem("testItem","testValue");if(storage.getItem("testItem")==="testValue"){storage.removeItem("testItem");return true}return false}catch(err){require(["core/log"],function(log){log.debug(err)});return false}};return{setAllowed:function(allowedOrNot){setAllowed(allowedOrNot)},storageAllowed:function(){return storageAllowed()},getStorageKey:function(){return encodeStorageKey()},Enabled:Enabled,init:function(userIdInit,assumeConsent,cleanUpFunc){userId=userIdInit;$(document).ready(function(){Enabled.local=storageInitialCheck(storageType.local);Enabled.session=storageInitialCheck(storageType.session);if(assumeConsent){userChoice=true}else if(storageAllowed()===null&&Enabled.local){setTimeout(function(){userChoice=obtainUserPreference(cleanUpFunc)},3e3)}$('a[href*="datapref"]').click(function(e){e.preventDefault();obtainUserPreference(cleanUpFunc)})})}}});
//# sourceMappingURL=browser_storage_set_up.min.js.map