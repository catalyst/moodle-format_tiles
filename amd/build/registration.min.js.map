{"version":3,"sourceRoot":"..","sources":["server/course/format/tiles/amd/src/registration.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript Module to help out if registration of pluign via curl fails.\n *\n * @module registration\n * @package course/format\n * @subpackage tiles\n * @copyright 2019 David Watson {@link http://evolutioncode.uk}\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since Moodle 3.3\n */\n\n/* eslint space-before-function-paren: 0 */\n\ndefine([\"jquery\", \"core/notification\", \"core/config\", \"core/str\"], function ($, Notification, config, str) {\n    \"use strict\";\n\n    return {\n        attemptRegistration: function(sesskey, serverUrl, data) {\n            data.useragent = navigator.userAgent;\n            data.browserlanguages = navigator.languages;\n            $(document).ready(function () {\n                $.ajax({\n                    url: serverUrl,\n                    type: 'POST',\n                    crossDomain: true,\n                    contentType: 'application/json',\n                    data: JSON.stringify(data),\n                    dataType: 'json',\n                    success: function(data) {\n                        if (data.status) {\n                            var stringKeys = [\n                                {key: \"registration\", component: \"admin\"},\n                                {key: \"registeredthanks\", component: \"format_tiles\"},\n                                {key: \"registerclicktocomplete\", component: \"format_tiles\"},\n                                {key: \"ok\", component: \"format_tiles\"},\n                                {key: \"cancel\"},\n                            ];\n                            str.get_strings(stringKeys).done(function (s) {\n                                Notification.confirm(\n                                    s[0],\n                                    s[1] + \" \" + s[2],\n                                    s[3],\n                                    s[4],\n                                    function() {\n                                        window.location.href = config.wwwroot\n                                            + '/course/format/tiles/register.php?key=' + data.key + \"&sesskey=\" + sesskey;\n                                    },\n                                    function() {\n                                        window.location.href = config.wwwroot + '/admin/settings.php?section=formatsettingtiles';\n                                    }\n                                );\n                            });\n                        }\n                    },\n                    error: Notification.exception\n                });\n            });\n        }\n    };\n\n});"],"names":["define","$","Notification","config","str","attemptRegistration","sesskey","serverUrl","data","useragent","navigator","userAgent","browserlanguages","languages","document","ready","ajax","url","type","crossDomain","contentType","JSON","stringify","dataType","success","status","stringKeys","key","component","get_strings","done","s","confirm","window","location","href","wwwroot","error","exception"],"mappings":"AA4BAA,OAAO,CAAC,SAAU,oBAAqB,cAAe,YAAa,SAAUC,EAAGC,aAAcC,OAAQC,KAClG,aAEA,MAAO,CACHC,oBAAqB,SAASC,QAASC,UAAWC,MAC9CA,KAAKC,UAAYC,UAAUC,UAC3BH,KAAKI,iBAAmBF,UAAUG,UAClCZ,EAAEa,QAAQ,EAAEC,MAAM,WACdd,EAAEe,KAAK,CACHC,IAAKV,UACLW,KAAM,OACNC,YAAa,KACbC,YAAa,mBACbZ,KAAMa,KAAKC,UAAUd,IAAI,EACzBe,SAAU,OACVC,QAAS,SAAShB,MACd,GAAIA,KAAKiB,OAAQ,CACb,IAAIC,WAAa,CACb,CAACC,IAAK,eAAgBC,UAAW,OAAO,EACxC,CAACD,IAAK,mBAAoBC,UAAW,cAAc,EACnD,CAACD,IAAK,0BAA2BC,UAAW,cAAc,EAC1D,CAACD,IAAK,KAAMC,UAAW,cAAc,EACrC,CAACD,IAAK,QAAQ,GAElBvB,IAAIyB,YAAYH,UAAU,EAAEI,KAAK,SAAUC,GACvC7B,aAAa8B,QACTD,EAAE,GACFA,EAAE,GAAK,IAAMA,EAAE,GACfA,EAAE,GACFA,EAAE,GACF,WACIE,OAAOC,SAASC,KAAOhC,OAAOiC,QACxB,yCAA2C5B,KAAKmB,IAAM,YAAcrB,OAC9E,EACA,WACI2B,OAAOC,SAASC,KAAOhC,OAAOiC,QAAU,gDAC5C,CACJ,CACJ,CAAC,CACL,CACJ,EACAC,MAAOnC,aAAaoC,SACxB,CAAC,CACL,CAAC,CACL,CACJ,CAEJ,CAAC"}