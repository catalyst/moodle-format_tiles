define(["jquery","core/config","core/str","core/ajax","format_tiles/edit_browser_storage"],function($,config,str,ajax,browserStorageEdit){"use strict";var Selector={EDITING_COLLAPSE_SECID:"#collapse",EDITING_COLLAPSE_SEC:".collapse-section",EDITING_EXPAND_SEC:".expand-section",EDITING_EXPAND_SECID:"#expand",ACTIVITY:"li.activity",SECTION_ID:"#section-",TILE_TITLE:"li.section.main .tile_bar_text .inplaceeditable a:not(.quickeditlink)",TILE_BAR_TEXT:".tile_bar_text",SECTION:"ul.section",SECTION_MAIN:"li.section.main",DNDUPLOAD_HIDDEN:"dndupload-hidden",ACTIVITYACTION:"a.cm-edit-action",ACTIONAREA:".actions",EXPAND_ALL_BTNS:".expand-collapse-all-btns a",EXPAND_COLLAPSE_SEC:".expand-collapse-sec ",EDIT_TITLE_PENCIL:".quickeditlink",ICON_PICKER_BTN:".tileiconcontainer",TILE_BAR:".tile_bar",SECTIONACTIONMENU:".section_action_menu",MENU_ACTION:".menu-action"};var Keyboard={ESCAPE:27,TAB:9,RETURN:13};var Event={CLICK:"click",KEYDOWN:"keydown",SCROLL:"scroll"};var DataAttributes={SECTION:"data-section",ORIG_TITLE:"data-original-title"};var courseId;var collapseSectionFromSecNum=function(secNum){var section=$(Selector.SECTION_ID+secNum);$(Selector.SECTION_ID+secNum+"-content").animate({opacity:0},300);section.find(Selector.ACTIVITY).slideUp(500);section.find(".section-modchooser").slideUp(500);section.addClass("collapsed").removeClass("expanded");section.find(".mod-chooser-outer").fadeOut(500);browserStorageEdit.setSectionStatus(secNum,false)};return{init:function(courseIdInit,useJavascriptNav,maxContentSectionsToStore,isMobile,sectionNum,storedContentExpirySecs,storedContentDeleteMins,useFilterButtons,assumeDataStoreConsent,reopenLastSection,userId,fitTilesToWidth,useWindowOverlay,pageType,allowPhotoTiles,useSubTiles,areConvertingLabel,documentationurl){courseId=courseIdInit;assumeDataStoreConsent=assumeDataStoreConsent==="1";require(["format_tiles/edit_icon_picker"],function(iconPicker){iconPicker.init(courseId,pageType,allowPhotoTiles,documentationurl)});if(useSubTiles){require(["format_tiles/edit_course_mod"],function(editCourseMod){editCourseMod.init(courseId,sectionNum,areConvertingLabel)})}$(document).ready(function(){$(Selector.TILE_BAR_TEXT).on(Event.KEYDOWN,function(e){if(e.keyCode===Keyboard.RETURN&&!$(e.target).hasClass("form-control")){window.location=config.wwwroot+"/course/view.php?id="+courseId+"&section="+$(e.currentTarget).parent().attr(DataAttributes.SECTION)}});if(useJavascriptNav&&!isMobile){var collapsingAllSectionFromURL=window.location.search.indexOf("expanded=-1")!==-1;var finalSectionInCourse=$(Selector.SECTION_MAIN).last().attr("data-section");browserStorageEdit.init(userId,courseId,maxContentSectionsToStore,storedContentDeleteMins,assumeDataStoreConsent,finalSectionInCourse,collapsingAllSectionFromURL)}if(!isMobile){var toolTips=$("[data-toggle=tooltip]");if(toolTips.length!==0){try{toolTips.tooltip()}catch(err){require(["core/log"],function(log){log.debug(err)})}}}$("body").on("click keypress",Selector.SECTION_MAIN+" "+Selector.SECTIONACTIONMENU+"[data-sectionid] "+"a[data-action]",function(e){var target=$(e.target).closest(Selector.MENU_ACTION);var sectionMain=target.closest(Selector.SECTION_MAIN);if(target.attr("data-action")==="hide"||target.attr("data-action")==="show"){collapseSectionFromSecNum(sectionMain.attr("data-section"));sectionMain.find(Selector.SECTION).find(Selector.ACTIVITY).slideUp(300).remove()}})})}}});
//# sourceMappingURL=edit_course.min.js.map